define("game",[],function(){var e=function(){},t=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])};return t(e,{getPlayer:function(e){return this.players[e]},getPlayerBy:function(e){var t=this.players,n=Object.keys(this.players).filter(function(n){var r=t[n];return e(r)});return n.length?t[n[0]]:null},getPlayerWithTurn:function(){return this.getPlayerBy(function(e){return e.status=="has_turn"})},getPlayerColor:function(e){var t=this.getPlayer(e);return t.playerColor},getOwnColor:function(){return this.getPlayerColor(this.ownPlayerID)},getOwnPlayer:function(){return this.getPlayer(this.ownPlayerID)},hasTurn:function(){var e=this.getOwnPlayer();return e.status=="has_turn"},isOver:function(){return this.status=="game_is_over"},getWinner:function(){return this.getPlayerBy(function(e){return e.status=="winner"})},initialize:function(e,t){this.loadMeta(t);if(Object.keys(e).length===0)for(var n=0;n<7;n++)e["row_"+n]||(e["row_"+n]=[]);this.state=e},loadMeta:function(e){this.players=e.players,this.status=e.status,this.ownPlayerID=e.ownPlayerID||e.ownPlayer.playerID},getRow:function(e){return this.state["row_"+e]},canPlace:function(e){var t=this.getRow(e);return this.hasTurn()&&t.length<6}}),e}),define("app",["game"],function(e){return{launch:function(){var t=new e,n=!1;Plynd.getGame(function(e,n){t.initialize(e,n),r(),i(),Plynd.Realtime.onEvent(f)}),$(window).resize(function(){r()});var r=function(){var e=$("#game-cont").height();$("#board").css("max-width",e*7/6)},i=function(){$("#board").empty();for(var e=0;e<7;e++){var t=o(e);$("#board").append(t)}u()},s=function(e){return $("<div/>",{"class":e})},o=function(e){var r=t.getRow(e),i=s("row");for(var o=0;o<6;o++){var u=s("sqHolder"),l=s("gem");u.append(l),o<r.length?l.css("background-color",t.getPlayerColor(r[o])):l.addClass("available"),i.prepend(u)}return i.on("mouseenter",function(){!n&&t.canPlace(e)&&(i.find(".available").last().css({"background-color":t.getOwnColor(),opacity:.6}),i.css("cursor","pointer"))}),i.on("mouseleave",function(){n||(i.find(".available").css({"background-color":"",opacity:1}),i.css("cursor",""))}),i.on("click",function(){!n&&t.canPlace(e)&&(n=!0,Plynd.call("onNewEvent",{row:e},f,a))}),i},u=function(){var e;if(t.isOver()){var n=t.getWinner();$("#turn-cont").css("background-color",n.playerColor),n.playerID==t.ownPlayerID?e="You won the game!":e=n.playerName+" won the game!"}else $("#turn-cont").css("background-color",t.getPlayerWithTurn().playerColor),e=t.hasTurn()?"It is your turn":"It is "+t.getPlayerWithTurn().playerName+"'s turn";$("#turn").text(e)},a=function(){n=!1},f=function(e,n){var r=t.getRow(e.row);r.push(e.playerID),t.loadMeta(n),i(),a()}}}});