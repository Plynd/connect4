define("winEvaluation",[],function(){return{isWinningBoard:function(e,t){var n=[];for(var r=0;r<7;r++){var i=e.getRow(r);for(var s=0;s<6;s++)i[s]==t&&(n[7*r+s]=!0)}return this.checkAlignment(n,1)?!0:this.checkAlignment(n,7)?!0:this.checkAlignment(n,8)?!0:this.checkAlignment(n,6)},shiftArrayLeft:function(e,t){var n=[];for(var r=t;r<e.length;r++)n[r-t]=e[r];return n},arrayAnd:function(e,t){var n=[];for(var r=0;r<e.length;r++)n[r]=e[r]+t[r];return n},checkAlignment:function(e,t){var n=this.shiftArrayLeft(e,0);for(var r=1;r<4;r++)n=this.arrayAnd(n,this.shiftArrayLeft(e,t*r));for(var i=0;i<n.length;i++)if(n[i])return!0;return!1}}}),define("game",[],function(){var e=function(){},t=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e.prototype[n]=t[n])};return t(e,{getPlayer:function(e){return this.players[e]},getPlayerBy:function(e){var t=this.players,n=Object.keys(this.players).filter(function(n){var r=t[n];return e(r)});return n.length?t[n[0]]:null},getPlayerWithTurn:function(){return this.getPlayerBy(function(e){return e.status=="has_turn"})},getPlayerColor:function(e){var t=this.getPlayer(e);return t.playerColor},getOwnColor:function(){return this.getPlayerColor(this.ownPlayerID)},getOwnPlayer:function(){return this.getPlayer(this.ownPlayerID)},hasTurn:function(){var e=this.getOwnPlayer();return e.status=="has_turn"},isOver:function(){return this.status=="game_is_over"},getWinner:function(){return this.getPlayerBy(function(e){return e.status=="winner"})},initialize:function(e,t){this.loadMeta(t);if(Object.keys(e).length===0)for(var n=0;n<7;n++)e["row_"+n]||(e["row_"+n]=[]);this.state=e},loadMeta:function(e){this.players=e.players,this.status=e.status,this.ownPlayerID=e.ownPlayerID||e.ownPlayer.playerID},getRow:function(e){return this.state["row_"+e]},canPlace:function(e){var t=this.getRow(e);return this.hasTurn()&&t.length<6}}),e}),define("server",["winEvaluation","game"],function(e,t){Plynd.ServerFunctions.onNewEvent=function(n,r,i){var s=n.row,o=new t;Plynd.getGame(function(t,n){o.initialize(t,n);if(!o.hasTurn())return i({code:403,data:"Not this player's turn"});var u=o.getRow(s);if(u.length>=6)return i({code:403,data:"The row "+s+" is full"});var a=o.getOwnPlayer(),f=a.playerID;u.push(f);var l={row:s};e.isWinningBoard(o,f)?l.winnerID=f:l.endTurn=!0,Plynd.updateGame(l,o.state,r,i)})}});